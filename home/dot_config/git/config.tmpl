# vim: syntax=gitconfig

[user]
	name = {{ .name | quote }}
	email = {{ .email | quote }}
	signingkey = {{ .signingkey | quote }}

[include]
	path = ~/.config/git/config.local
[include]
	path = "~/.config/git/themes.gitconfig"

[core]
	editor = nvim
	pager = delta
	autocrlf = input
	whitespace = trailing-space,space-before-tab
	excludesfile = ~/.config/git/ignore
	sshCommand = ssh -i ~/.ssh/id_ed25519

[init]
	defaultBranch = main

[pull]
	rebase = true

[push]
	default = simple
	autoSetupRemote = true
	followTags = true

[fetch]
	prune = true
	pruneTags = true

[rebase]
	autoStash = true
	autoSquash = true

[merge]
	conflictstyle = zdiff3
	tool = cursor

[mergetool "cursor"]
	cmd = cursor --wait --merge $REMOTE $LOCAL $BASE $MERGED

[diff]
	algorithm = histogram
	colorMoved = default
	tool = difftastic
	mnemonicPrefix = true
	renames = copies

[difftool]
	prompt = false

[difftool "difftastic"]
	cmd = difft "$LOCAL" "$REMOTE"

[pager]
	difftool = true

[interactive]
	diffFilter = delta --color-only

[delta]
	navigate = true
	light = false
	side-by-side = true
	line-numbers = true
	syntax-theme = Monokai Extended
	plus-style = "syntax #003800"
	minus-style = "syntax #3f0001"
	file-style = bold yellow ul
	file-decoration-style = none
	file-added-label = [+]
	file-copied-label = [==]
	file-modified-label = [*]
	file-removed-label = [-]
	file-renamed-label = [->]
	hunk-header-decoration-style = blue box
	hunk-header-file-style = red
	hunk-header-line-number-style = "#067a00"
	hunk-header-style = file line-number syntax
	line-numbers-left-format = "{nm:>4}┊"
	line-numbers-right-format = "{np:>4}│"
	line-numbers-left-style = cyan
	line-numbers-right-style = cyan
	line-numbers-minus-style = 124
	line-numbers-plus-style = 28
	line-numbers-zero-style = "#999999"

[delta "interactive"]
	keep-plus-minus-markers = false

[delta "decorations"]
	commit-decoration-style = blue ol
	commit-style = raw
	file-style = omit
	hunk-header-decoration-style = blue box
	hunk-header-file-style = red
	hunk-header-line-number-style = "#067a00"
	hunk-header-style = file line-number syntax

[color]
	ui = auto
	branch = auto
	diff = auto
	interactive = auto
	status = auto

[color "branch"]
	current = yellow reverse
	local = yellow
	remote = green

[color "diff"]
	meta = yellow bold
	frag = magenta bold
	old = red bold
	new = green bold

[color "status"]
	added = yellow
	changed = green
	untracked = cyan

[alias]
	# Short aliases
	st = status -sb
	co = checkout
	br = branch
	ci = commit
	unstage = reset HEAD --
	last = log -1 HEAD

	# Log aliases
	lg = log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit
	ll = log --pretty=format:"%C(yellow)%h%Cred%d\\ %Creset%s%Cblue\\ [%cn]" --decorate --numstat
	lol = log --graph --decorate --oneline --all
	lola = log --graph --decorate --oneline --all --simplify-by-decoration

	# Diff aliases
	d = diff
	ds = diff --staged
	dt = difftool
	dts = difftool --staged

	# Show diff using difftastic
	dft = difftool

	# Amend without editing message
	amend = commit --amend --no-edit

	# List aliases
	aliases = config --get-regexp alias

	# Undo last commit but keep changes
	undo = reset --soft HEAD^

	# Clean up merged branches
	cleanup = "!git branch --merged | grep -v '\\*\\|main\\|master\\|develop' | xargs -n 1 git branch -d"

	# Quick stash operations
	stash-all = stash save --include-untracked

	# Find commits by message
	find = "!git log --pretty=format:'%C(yellow)%h %Cblue%ad %Creset%s%Cgreen [%cn] %Cred%d' --decorate --date=short --grep"

	# Find commits by file
	filelog = log -u

	# Show modified files in last commit
	dl = "!git ll -1"

	# Show a diff last commit
	dlc = diff --cached HEAD^

	# Show content of commit
	dr = "!f() { git diff \"$1\"^..\"$1\"; }; f"
	lc = "!f() { git ll \"$1\"^..\"$1\"; }; f"

	# Find a file in the codebase
	f = "!git ls-files | grep -i"

	# Search for text in codebase
	grep = grep -Ii

	# List contributors
	contributors = shortlog --summary --numbered

	# Show current branch
	current = rev-parse --abbrev-ref HEAD

[help]
	autocorrect = 1

[commit]
	verbose = true
	gpgsign = true

[tag]
	gpgSign = true

[status]
	showUntrackedFiles = all

[transfer]
	fsckobjects = true

[receive]
	fsckObjects = true

{{- if eq .class "Work" }}
{{/* [url "git@github.com-work:"]
	insteadOf = git@github.com: */}}

[credential]
	helper =
	helper = /usr/local/share/gcm-core/git-credential-manager

[credential "https://dev.azure.com"]
	useHttpPath = true

[credential "https://github.com"]
	helper =
	helper = !/opt/homebrew/bin/gh auth git-credential

[credential "https://gist.github.com"]
	helper =
	helper = !/opt/homebrew/bin/gh auth git-credential
{{- end }}
